<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Generator Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-header">
        <div class="header-content">
            <div class="logo"> 
                <h1>Certificate Generator</h1>
            </div>
            <div class="header-actions">
                <div class="theme-switcher">
                    <button class="theme-btn" onclick="toggleTheme()" title="Switch Theme">
                        <i class="fas fa-sun" id="themeIcon"></i>
                    </button>
                    <div class="theme-dropdown" id="themeDropdown">
                        <button class="theme-option" onclick="setTheme('light')">
                            <i class="fas fa-sun"></i>
                            Light
                        </button>
                        <button class="theme-option" onclick="setTheme('dark')">
                            <i class="fas fa-moon"></i>
                            Dark
                        </button>
                        <button class="theme-option" onclick="setTheme('system')">
                            <i class="fas fa-desktop"></i>
                            System
                        </button>
                    </div>
                </div>
                <button class="btn btn-secondary patch-notes-btn" onclick="showPatchNotes()">
                    <i class="fas fa-sparkles"></i>
                    What's New
                </button>
                <button class="btn btn-primary" onclick="generateCertificates()">
                    <i class="fas fa-download"></i>
                    Generate Certificates
                </button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <div class="sidebar left-sidebar">
            <div class="panel-header">
                <i class="fas fa-upload"></i>
                <h3>Upload Files</h3>
            </div>

            <div class="upload-section">
                <div class="file-upload">
                    <label for="excelInput" class="upload-label">
                        <i class="fas fa-file-excel"></i>
                        <span>Upload Excel File</span>
                        <small>(.xlsx, .xls)</small>
                    </label>
                    <input type="file" id="excelInput" accept=".xlsx, .xls" hidden>
                </div>

                <div class="file-upload">
                    <label for="templateInput" class="upload-label">
                        <i class="fas fa-image"></i>
                        <span>Upload Template</span>
                        <small>(image files)</small>
                    </label>
                    <input type="file" id="templateInput" accept="image/*" hidden>
                </div>
            </div>

            <div class="field-selection">
                <div class="panel-header">
                    <i class="fas fa-list"></i>
                    <h3>Field Selection</h3>
                </div>
                <select id="fieldSelect" class="field-select">
                    <option value="">Select a field to edit</option>
                </select>
                <div id="fieldCheckboxes" class="field-checkboxes"></div>
            </div>
        </div>

        <div class="main-content">
            <div class="canvas-container">
                <div class="canvas-header">
                    <h3>Preview</h3>
                    <div class="canvas-controls">
                        <button class="btn btn-secondary" onclick="resetAllPositions()">
                            <i class="fas fa-undo"></i>
                            Reset All
                        </button>
                    </div>
                </div>
                <div class="canvas-wrapper">
                    <canvas id="preview"></canvas>
                    <div class="canvas-placeholder" id="canvasPlaceholder">
                        <i class="fas fa-image"></i>
                        <p>Upload a template image to get started</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar right-sidebar">
            <div class="panel-header">
                <i class="fas fa-palette"></i>
                <h3>Text Styling</h3>
            </div>

            <div class="style-controls">
                <div class="control-group">
                    <label><i class="fas fa-font"></i> Font Family</label>
                    <div class="font-controls">
                        <input type="text" id="fontSearch" placeholder="Search fonts..." class="font-search">
                        <select id="fontSelect" class="font-select">
                            <option value="Arial">Arial</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Courier">Courier</option>
                        </select>
                    </div>
                </div>

                <div class="control-group">
                    <label><i class="fas fa-text-height"></i> Font Size</label>
                    <div class="size-control">
                        <input type="range" id="fontSizeRange" min="8" max="72" value="16" class="size-slider">
                        <input type="number" id="fontSize" value="16" min="8" max="72" class="size-input">
                    </div>
                </div>

                <div class="control-group">
                    <label><i class="fas fa-align-left"></i> Text Alignment</label>
                    <div class="align-buttons">
                        <button class="align-btn active" data-align="left"><i class="fas fa-align-left"></i></button>
                        <button class="align-btn" data-align="center"><i class="fas fa-align-center"></i></button>
                        <button class="align-btn" data-align="right"><i class="fas fa-align-right"></i></button>
                    </div>
                    <select id="textAlign" hidden>
                        <option value="left">Left</option>
                        <option value="center">Center</option>
                        <option value="right">Right</option>
                    </select>
                </div>

                <div class="control-group">
                    <label><i class="fas fa-palette"></i> Text Color</label>
                    <div class="color-control">
                        <input type="color" id="textColor" value="#000000" class="color-picker">
                        <span class="color-value">#000000</span>
                    </div>
                </div>
            </div>

            <div class="position-controls">
                <div class="panel-header">
                    <i class="fas fa-arrows-alt"></i>
                    <h3>Position Controls</h3>
                </div>

                <div class="movement-grid">
                    <button class="move-btn" onclick="moveText('up')">
                        <i class="fas fa-chevron-up"></i>
                    </button>
                    <div class="move-center">
                        <button class="move-btn" onclick="moveText('left')">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="reset-btn" onclick="resetPosition()">
                            <i class="fas fa-crosshairs"></i>
                        </button>
                        <button class="move-btn" onclick="moveText('right')">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <button class="move-btn" onclick="moveText('down')">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>

                <div class="precision-controls">
                    <label>Move Step Size</label>
                    <select id="moveStep" class="step-select">
                        <option value="1">1px (Fine)</option>
                        <option value="5" selected>5px (Normal)</option>
                        <option value="10">10px (Coarse)</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Patch Notes Modal -->
    <div class="patch-notes-overlay" id="patchNotesOverlay">
        <div class="patch-notes-modal">
            <div class="patch-notes-header">
                <div class="patch-notes-title">
                    <i class="fas fa-rocket"></i>
                    <h2>What's New in Certificate Generator Pro</h2>
                    <span class="version-badge">v2.0</span>
                </div>
                <button class="close-btn" onclick="closePatchNotes()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="patch-notes-content">
                <div class="update-section">
                    <div class="update-header">
                        <i class="fas fa-palette"></i>
                        <h3>🎨 Complete Design Overhaul</h3>
                    </div>
                    <ul class="update-list">
                        <li>Modern, clean interface with professional styling</li>
                        <li>Intuitive sidebar layout for better organization</li>
                        <li>Beautiful drag-and-drop file upload areas</li>
                        <li>Responsive design that works on all devices</li>
                        <li>Smooth animations and hover effects</li>
                    </ul>
                </div>

                <div class="update-section">
                    <div class="update-header">
                        <i class="fas fa-tools"></i>
                        <h3>🔧 Fixed Major Issues</h3>
                    </div>
                    <ul class="update-list">
                        <li><strong>Dragging System:</strong> Fixed mouse coordinate calculations for accurate text
                            positioning</li>
                        <li><strong>Movement Controls:</strong> Directional buttons now work properly with visual
                            feedback</li>
                        <li><strong>Text Alignment:</strong> Improved left, center, and right alignment handling</li>
                        <li><strong>Canvas Bounds:</strong> Text now stays within canvas boundaries</li>
                        <li><strong>Font Loading:</strong> Better error handling and fallback fonts</li>
                    </ul>
                </div>

                <div class="update-section">
                    <div class="update-header">
                        <i class="fas fa-star"></i>
                        <h3>✨ New Features</h3>
                    </div>
                    <ul class="update-list">
                        <li><strong>Advanced Font Controls:</strong> Search fonts, size slider, and visual alignment
                            buttons</li>
                        <li><strong>Precision Movement:</strong> Adjustable step size (1px, 5px, 10px) for fine control
                        </li>
                        <li><strong>Better Visual Feedback:</strong> Loading states, success indicators, and progress
                            tracking</li>
                        <li><strong>Enhanced Canvas:</strong> Selection indicators, hover detection, and proper scaling
                        </li>
                        <li><strong>Improved Generation:</strong> Progress indicator and better filename handling</li>
                    </ul>
                </div>

                <div class="update-section">
                    <div class="update-header">
                        <i class="fas fa-user-check"></i>
                        <h3>🚀 User Experience</h3>
                    </div>
                    <ul class="update-list">
                        <li>Intuitive drag-and-drop interface for text positioning</li>
                        <li>Real-time preview updates as you make changes</li>
                        <li>Clear visual indicators for selected text fields</li>
                        <li>Professional color scheme and typography</li>
                        <li>Accessible design following modern web standards</li>
                    </ul>
                </div>
            </div>

            <div class="patch-notes-footer">
                <button class="btn btn-primary" onclick="closePatchNotes()">
                    <i class="fas fa-check"></i>
                    Got it, thanks!
                </button>
                <label class="dont-show-again">
                    <input type="checkbox" id="dontShowAgain">
                    Don't show this again
                </label>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-left">
                <p>© 2025 Certificate Generator Pro. All rights reserved.</p>
            </div>
            <div class="footer-right">
                <p>Developed with ❤️ by
                    <a href="https://anandubkurup.com" target="_blank" rel="noopener noreferrer">
                        Anandu B Kurup
                    </a>
                </p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>

</html>